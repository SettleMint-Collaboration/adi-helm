# TLS with cert-manager
# Layer this on top of your base values file
#
# Prerequisites:
#   # 1. Install cert-manager with Helm
#   helm repo add jetstack https://charts.jetstack.io
#   helm repo update
#   helm install cert-manager jetstack/cert-manager \
#     -n cert-manager --create-namespace \
#     --set crds.enabled=true \
#     --set extraArgs={--enable-gateway-api}
#
#   # 2. Create ClusterIssuer (edit email first!)
#   kubectl apply -f https://raw.githubusercontent.com/settlemint/adi-helm/main/adi-stack/examples/support/cert-manager-clusterissuer.yaml
#
# Usage with Contour HTTPProxy:
#   helm install adi-stack ./adi-stack -n adi-testnet --create-namespace \
#     -f examples/values-testnet.yaml \
#     -f examples/values-ingress-contour.yaml \
#     -f examples/values-tls-certmanager.yaml \
#     --set ingress.hostname=testnet.example.com

ingress:
  tls:
    enabled: true
    # Leave empty - cert-manager will create the secret automatically
    secretName: ""

  # Gateway API cert-manager integration
  # Creates a Certificate resource that provisions the TLS secret
  certManager:
    enabled: true
    issuerRef:
      name: "letsencrypt-prod"
      kind: "ClusterIssuer"
    # Optional: customize certificate lifetime
    # duration: "2160h"    # 90 days (default)
    # renewBefore: "360h"  # 15 days before expiry (default)

  # Kubernetes Ingress cert-manager integration (via annotations)
  # Used when ingress.type is "ingress" instead of "gateway"
  kubernetes:
    annotations:
      cert-manager.io/cluster-issuer: "letsencrypt-prod"
