# Contour Helm Chart Values for Azure AKS
# Official projectcontour Helm chart with Gateway API and external LoadBalancer
#
# Prerequisites:
#   # Add the official Contour Helm repository
#   helm repo add projectcontour https://projectcontour.io/charts
#   helm repo update
#
# Install:
#   helm install contour projectcontour/contour \
#     -n projectcontour --create-namespace \
#     -f https://raw.githubusercontent.com/settlemint/adi-helm/main/adi-stack/examples/support/contour-values-azure.yaml
#
# Verify:
#   kubectl get gatewayclass contour
#   kubectl get pods -n projectcontour
#   kubectl get svc -n projectcontour envoy
#
# Get LoadBalancer IP:
#   kubectl get svc -n projectcontour envoy -o jsonpath='{.status.loadBalancer.ingress[0].ip}'

# Contour controller settings
contour:
  ingressClass:
    create: true
    name: contour
    default: false

# Envoy proxy settings
envoy:
  # Use Deployment for easier scaling
  workload:
    type: Deployment
    replicas: 2

  # Service configuration for Azure
  service:
    type: LoadBalancer
    externalTrafficPolicy: Local
    # Azure LoadBalancer annotations
    annotations:
      # Public LoadBalancer (default, but explicit for clarity)
      service.beta.kubernetes.io/azure-load-balancer-internal: "false"
      # Optional: specify resource group for public IP
      # service.beta.kubernetes.io/azure-load-balancer-resource-group: "my-rg"

# Gateway API configuration
gatewayAPI:
  enabled: true

# GatewayClass for adi-stack Gateway resources
gatewayClass:
  create: true
  name: contour
